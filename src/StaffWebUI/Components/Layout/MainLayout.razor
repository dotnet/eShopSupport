@using Microsoft.FluentUI.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Authorization
@using System.Security.Claims
@inherits LayoutComponentBase

<div class="app">
    <FluentLayout>
        <FluentHeader Height="@(default)">
            <a href="" class="main-title">
                eShopSupport
            </a>
            <SectionOutlet SectionName="PageTitle" />
            <AuthorizeView>
                @GetUserDisplayName(context.User)
            </AuthorizeView>
            <span class="theme-picker">
                <ThemePicker />
            </span>
        </FluentHeader>
        @Body
    </FluentLayout>
</div>

<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">🗙</a>
</div>

@code {
    string GetUserDisplayName(ClaimsPrincipal principal)
        => principal.Claims.FirstOrDefault(c => c.Type == "name")?.Value ?? "Unknown name";
}
